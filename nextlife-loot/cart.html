<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Your Cart — Next‑Life Loot</title>
<link rel="stylesheet" href="assets/styles.css">
</head><body>
<header class="header"><div class="container nav">
  <div class="logo"><span class="badge">✨</span>Next‑Life Loot</div>
  <nav class="row" style="gap:10px">
    <a class="btn ghost" href="index.html">Home</a>
    <a class="btn ghost" href="shop.html">Shop</a>
    <a class="btn ghost" href="contact.html">Contact</a>
  </nav>
  <div class="grow"></div>
  <select id="ccy" class="select" style="width:auto">
    <option value="BHD">BHD د.ب</option><option value="USD">USD $</option><option value="EUR">EUR €</option><option value="GBP">GBP £</option>
  </select>
</div></header>

<main class="container">
  <h1 style="margin:6px 0 12px">Your Cart</h1>
  <table class="table" id="table"><thead><tr><th>Item</th><th>Qty</th><th>Price</th><th>Total</th><th></th></tr></thead><tbody></tbody></table>
  <p id="empty" class="small" style="display:none">Your cart is empty.</p>
  <div class="row" style="justify-content:flex-end;gap:12px;margin-top:10px">
    <div class="card pad">
      <div class="row spread"><span class="small">Subtotal</span><strong id="subtotal">$0.00</strong></div>
      <div class="row spread"><span class="small">VAT (demo)</span><span id="vat" class="small">$0.00</span></div>
      <hr style="border:none;border-top:1px solid var(--line);margin:8px 0">
      <div class="row spread"><span class="small">Total</span><strong id="grand">$0.00</strong></div>
      <div style="height:8px"></div>
      <button class="btn primary" disabled id="checkout">Checkout (coming soon)</button>
      <p class="small">Payment integration will be added later (Stripe / PayPal / Tabby).</p>
    </div>
  </div>
</main>

<footer class="footer">© <span id="year"></span> Next‑Life Loot</footer>
<script src="assets/app.js"></script>
<script>
(async function(){
  bindHeader();
  const data = await loadProducts();
  const ccy = STORE.getCurrency();
  const cart = STORE.getCart();
  const tbody = document.querySelector('#table tbody');
  function render(){
    tbody.innerHTML='';
    let any=false, subUSD=0;
    for(const [id,qty] of Object.entries(STORE.getCart())){
      const p = data.find(x=>x.id===id); if(!p) continue;
      any=true; const row = document.createElement('tr');
      const lineUSD = p.priceUSD * qty; subUSD += lineUSD;
      row.innerHTML = `
        <td><div class="row"><img src="${p.img}" alt="${p.name}" style="width:56px;height:56px;object-fit:cover;border-radius:8px"><div><div style="font-weight:600">${p.name}</div><div class="small">${p.condition}</div></div></div></td>
        <td><input type="number" min="1" value="${qty}" style="width:70px" class="input"></td>
        <td>${moneyUSDTo(ccy, p.priceUSD)}</td>
        <td>${moneyUSDTo(ccy, lineUSD)}</td>
        <td><button class="btn ghost">Remove</button></td>`;
      row.querySelector('input').addEventListener('change', e=>{ STORE.setQty(id, e.target.value); document.dispatchEvent(new Event('cart:updated')); render(); });
      row.querySelector('button').addEventListener('click', ()=>{ STORE.remove(id); document.dispatchEvent(new Event('cart:updated')); render(); });
      tbody.appendChild(row);
    }
    document.getElementById('empty').style.display = any? 'none':'block';
    const vatUSD = subUSD * 0.00; // demo VAT
    document.getElementById('subtotal').textContent = moneyUSDTo(ccy, subUSD);
    document.getElementById('vat').textContent = moneyUSDTo(ccy, vatUSD);
    document.getElementById('grand').textContent = moneyUSDTo(ccy, subUSD + vatUSD);
    document.getElementById('checkout').disabled = !any;
  }
  document.addEventListener('currency:changed', render);
  render();
  document.getElementById('year').textContent = new Date().getFullYear();
})();
</script>
</body></html>