<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Shop â€” Nextâ€‘Life Loot</title>
<link rel="stylesheet" href="assets/styles.css">
</head><body>
<header class="header"><div class="container nav">
  <div class="logo"><span class="badge">âœ¨</span>Nextâ€‘Life Loot</div>
  <nav class="row" style="gap:10px">
    <a class="btn ghost" href="index.html">Home</a>
    <a class="btn ghost" href="shop.html">Shop</a>
    <a class="btn ghost" href="contact.html">Contact</a>
    <a class="btn" href="cart.html">ðŸ›’ <span id="cartMini">0 â€¢ $0.00</span></a>
  </nav>
  <div class="grow"></div>
  <select id="ccy" class="select" style="width:auto">
    <option value="BHD">BHD Ø¯.Ø¨</option><option value="USD">USD $</option><option value="EUR">EUR â‚¬</option><option value="GBP">GBP Â£</option>
  </select>
</div></header>

<main class="container">
  <h1 style="margin:6px 0 12px">Shop</h1>
  <div class="row" style="gap:10px;flex-wrap:wrap;margin-bottom:10px">
    <div class="tabs" id="tabs">
      <button class="tab active" data-tab="all">All</button>
      <button class="tab" data-tab="controllers">Controllers</button>
      <button class="tab" data-tab="merch">Merch</button>
    </div>
    <div class="grow"></div>
    <input id="q" class="input" placeholder="Searchâ€¦">
    <select id="sort" class="select">
      <option value="popular">Popular</option>
      <option value="price-asc">Price â†‘</option>
      <option value="price-desc">Price â†“</option>
      <option value="name">Name Aâ€‘Z</option>
    </select>
  </div>
  <div id="grid" class="grid"></div>
  <p id="empty" class="small" style="display:none;text-align:center;padding:18px">No items match.</p>
</main>

<footer class="footer">Â© <span id="year"></span> Nextâ€‘Life Loot</footer>
<script src="assets/app.js"></script>
<script>
(async function(){
  bindHeader();
  const data = await loadProducts();
  const grid = document.getElementById('grid');
  const empty = document.getElementById('empty');
  let tab='all', q='', sort='popular';
  const ccy = ()=> STORE.getCurrency();

  function apply(){
    grid.innerHTML='';
    let items = data.filter(p=> (tab==='all'||p.category===tab) && (!q || (p.name+' '+p.notes).toLowerCase().includes(q)));
    if(sort==='price-asc') items.sort((a,b)=>a.priceUSD-b.priceUSD);
    if(sort==='price-desc') items.sort((a,b)=>b.priceUSD-a.priceUSD);
    if(sort==='name') items.sort((a,b)=>a.name.localeCompare(b.name));
    empty.style.display = items.length? 'none':'block';
    for(const p of items){
      const card = document.createElement('article');
      card.className='card';
      card.innerHTML = `
        <a href="product.html?id=${p.id}"><div class="pimg"><img src="${p.img}" alt="${p.name}"></div></a>
        <div style="padding:12px 16px">
          <div class="ptitle">${p.name}</div>
          <div class="pmeta">${p.notes}</div>
          <div class="row spread" style="margin-top:8px">
            <strong>${moneyUSDTo(ccy(), p.priceUSD)}</strong>
            <div class="row" style="gap:6px">
              <a class="btn ghost" href="product.html?id=${p.id}">Details</a>
              <button class="btn primary" data-add="${p.id}">Add</button>
            </div>
          </div>
        </div>`;
      card.querySelector('[data-add]').addEventListener('click', ()=>{ STORE.add(p.id,1); document.dispatchEvent(new Event('cart:updated')); });
      grid.appendChild(card);
    }
  }

  document.getElementById('q').addEventListener('input', e=>{ q=e.target.value.toLowerCase(); apply(); });
  document.getElementById('sort').addEventListener('change', e=>{ sort=e.target.value; apply(); });
  document.getElementById('tabs').addEventListener('click', e=>{
    if(e.target.matches('.tab')){
      document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active'));
      e.target.classList.add('active');
      tab = e.target.dataset.tab; apply();
    }
  });
  document.addEventListener('currency:changed', apply);

  apply();
  document.getElementById('year').textContent = new Date().getFullYear();
})();
</script>
</body></html>